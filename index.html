<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Ryane's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="Android Developer">
<meta property="og:type" content="website">
<meta property="og:title" content="Ryane's Blog">
<meta property="og:url" content="lijianchang.xyz/index.html">
<meta property="og:site_name" content="Ryane's Blog">
<meta property="og:description" content="Android Developer">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ryane's Blog">
<meta name="twitter:description" content="Android Developer">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Ryane's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Ryane's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/Java容器类源码-ArrayList的最全的源码分析/" itemprop="url">
                  未命名
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T09:50:04+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          


          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/Java容器类源码-ArrayList的最全的源码分析/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/Java容器类源码-ArrayList的最全的源码分析/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          
		  
		 

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>本文是针对Java 1.8的源代码进行解析的，可能会和其他版本有所出入。</p>
<h1 id="一、继承和实现"><a href="#一、继承和实现" class="headerlink" title="一、继承和实现"></a>一、继承和实现</h1><ul>
<li><p><strong>继承：</strong>AbstractList</p>
</li>
<li><p><strong>实现：</strong>List<e>, RandomAccess, Cloneable, Serializable接口</e></p>
</li>
</ul>
<h3 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h3><pre><code>public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt;
    implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable{
}
</code></pre><h1 id="二、全局变量"><a href="#二、全局变量" class="headerlink" title="二、全局变量"></a>二、全局变量</h1><h3 id="1-默认容量"><a href="#1-默认容量" class="headerlink" title="1. 默认容量"></a>1. 默认容量</h3><pre><code>private static final int DEFAULT_CAPACITY = 10;
</code></pre><h3 id="2-空的对象数组"><a href="#2-空的对象数组" class="headerlink" title="2. 空的对象数组"></a>2. 空的对象数组</h3><pre><code>private static final Object[] EMPTY_ELEMENTDATA = {};
</code></pre><h3 id="3-默认的空数组"><a href="#3-默认的空数组" class="headerlink" title="3.默认的空数组"></a>3.默认的空数组</h3><pre><code>// 无参构造函数创建的数组
private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};
</code></pre><h3 id="4-存放数据的数组的缓存变量，不可序列化"><a href="#4-存放数据的数组的缓存变量，不可序列化" class="headerlink" title="4.存放数据的数组的缓存变量，不可序列化"></a>4.存放数据的数组的缓存变量，不可序列化</h3><pre><code>transient Object[] elementData;
</code></pre><h3 id="5-数组的大小"><a href="#5-数组的大小" class="headerlink" title="5.数组的大小"></a>5.数组的大小</h3><pre><code>private int size;
</code></pre><h1 id="三、构造方法"><a href="#三、构造方法" class="headerlink" title="三、构造方法"></a>三、构造方法</h1><h3 id="1-带有容量initialCapacity的构造方法"><a href="#1-带有容量initialCapacity的构造方法" class="headerlink" title="1.带有容量initialCapacity的构造方法"></a>1.带有容量initialCapacity的构造方法</h3><p><strong>源码解释：</strong></p>
<pre><code>public ArrayList(int initialCapacity) {
     // 如果初始化时ArrayList大小大于0
    if (initialCapacity &gt; 0) {
          // new一个该大小的object数组赋给elementData
        this.elementData = new Object[initialCapacity];
    } else if (initialCapacity == 0) { // 如果大小为0
          // 将空数组赋给elementData
        this.elementData = EMPTY_ELEMENTDATA;
    } else { // 小于0
          // 则抛出IllegalArgumentException异常
        throw new IllegalArgumentException(&quot;Illegal Capacity: &quot;+
                                           initialCapacity);
    }
}
</code></pre><h3 id="2-不带参数的构造方法"><a href="#2-不带参数的构造方法" class="headerlink" title="2.不带参数的构造方法"></a>2.不带参数的构造方法</h3><p><strong>源码解释：</strong></p>
<pre><code>public ArrayList() {
     // 直接将空数组赋给elementData  
    this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
}
</code></pre><h3 id="3-带参数Collection的构造方法"><a href="#3-带参数Collection的构造方法" class="headerlink" title="3.带参数Collection的构造方法"></a>3.带参数Collection的构造方法</h3><p><strong>源码解释：</strong></p>
<p>参数c为一个Collection，Collection的实现类大概有以下几种常用类型：</p>
<ul>
<li>List：元素可以重复的容器</li>
<li>Set: 元素不可重复的容器</li>
<li>Queue:结构是一个队列，先进先出</li>
</ul>
<p>这个构造方法的意思是，将一个Collection实现类的对象转换为一个ArrayList，但是c容器装的内容</p>
<p>必须为ArrayList装的内容的子类。例如，将一个装了String内容的HashSet转换为装了String内容的</p>
<p>ArrayList，使得ArrayList的大小和值数组都是HashSet的大小和值数组。具体实现如下代码，首先调</p>
<p>用c(Collection的具体实现类)的toArray方法，具体大家可以看各个实现类的toArray方法，但是大</p>
<p>概意思都是将c容器转换为object类型的数组，因为它们的返回值都是object[]。之于下面的两个判断</p>
<p>是当得到的elementData的类名不是Object类名的时候或者是长度为0的时候才会执行。</p>
<pre><code>public ArrayList(Collection&lt;? extends E&gt; c) {
    elementData = c.toArray();
    if ((size = elementData.length) != 0) {
        if (elementData.getClass() != Object[].class)
            elementData = Arrays.copyOf(elementData, size, Object[].class);
    } else {
        // replace with empty array.
        this.elementData = EMPTY_ELEMENTDATA;
    }
}  
</code></pre><h1 id="四、方法"><a href="#四、方法" class="headerlink" title="四、方法"></a>四、方法</h1><h3 id="1-trimToSize"><a href="#1-trimToSize" class="headerlink" title="1.trimToSize()"></a>1.trimToSize()</h3><p><strong>说明：</strong>将ArrayList的容量设置为当前size的大小。首先需要明确一个概念，ArrayList的size就是ArrayList的元素个数，length是ArrayList申请的内容空间长度。ArrayList每次都会预申请多一点空间，以便添加元素的时候不需要每次都进行扩容操作，例如我们的元素个数是10个，它申请的内存空间必定会大于10，即length&gt;size，而这个方法就是把ArrayList的内存空间设置为size，去除没有用到的null值空间。这也就是我们为什么每次在获取数据长度是都是调用list.size()而不是list.length()。</p>
<p><strong>源码解释：</strong>首先modCount是从类 java.util.AbstractList 继承的字段，这个字段主要是为了防止在多线程操作的情况下，List发生结构性的变化，什么意思呢？就是防止一个线程正在迭代，另外一个线程进行对List进行remove操作，这样当我们迭代到最后一个元素时，很明显此时List的最后一个元素为空，那么这时modCount就会告诉迭代器，让其抛出异常 ConcurrentModificationException。</p>
<blockquote>
<p>如果没有这一个变量，那么系统肯定会报异常ArrayIndexOutOfBoundsException，这样的异常显然不是应该出现的(这些运行时错误都是使用者的逻辑错误导致的，我们的JDK那么高端，不会出现使用错误，我们只抛出使用者造成的错误，而这个错误是设计者应该考虑的)，为了避免出现这样的异常，定义了检查。</p>
</blockquote>
<p>(引用自：郭无心，详情可以看他在知乎的回答：<a href="https://www.zhihu.com/question/24086463/answer/64717159" target="_blank" rel="external">https://www.zhihu.com/question/24086463/answer/64717159</a>)。</p>
<pre><code>public void trimToSize() {
    modCount++;
     // 如果size小于length
    if (size &lt; elementData.length) {
         // 重新将elementData设置大小为size
        elementData = (size == 0)
          ? EMPTY_ELEMENTDATA
          : Arrays.copyOf(elementData, size);
    }
}  
</code></pre><h3 id="2-size"><a href="#2-size" class="headerlink" title="2.size()"></a>2.size()</h3><p><strong>说明：</strong>返回ArrayList的大小</p>
<p><strong>源码解释：</strong>直接返回size</p>
<pre><code>public int size() {
    return size;
}
</code></pre><h3 id="3-isEmpty"><a href="#3-isEmpty" class="headerlink" title="3.isEmpty()"></a>3.isEmpty()</h3><p><strong>说明：</strong>返回是否为空</p>
<p><strong>源码解释： </strong>直接返回判断size==0 </p>
<pre><code>public boolean isEmpty() {
    return size == 0;
}
</code></pre><h3 id="4-indexOf-Object-o"><a href="#4-indexOf-Object-o" class="headerlink" title="4.indexOf(Object o)"></a>4.indexOf(Object o)</h3><p><strong>说明：</strong>对象o在ArrayList中的下标位置，如果存在返回位置i，不存在返回-1</p>
<p><strong>源码解释：</strong>遍历ArrayList的大小，比较o和容器内的元素，若相等，则返回位置i，若遍历完都不相等，返回-1</p>
<pre><code>public int indexOf(Object o) {
    if (o == null) {
        for (int i = 0; i &lt; size; i++)
            if (elementData[i]==null)
                return i;
    } else {
        for (int i = 0; i &lt; size; i++)
            if (o.equals(elementData[i]))
                return i;
    }
    return -1;
}  
</code></pre><h3 id="5-contains-Object-o"><a href="#5-contains-Object-o" class="headerlink" title="5.contains(Object o)"></a>5.contains(Object o)</h3><p><strong>说明：</strong>是否包含对象o</p>
<p><strong>源码解释：</strong>调用indexOf()方法得到下标，存在则下标&gt;=0，不存在为-1，即只要比较下标和0的大小即可。</p>
<pre><code>public boolean contains(Object o) {
    return indexOf(o) &gt;= 0;
}
</code></pre><h3 id="6-lastIndexOf-Object-o"><a href="#6-lastIndexOf-Object-o" class="headerlink" title="6.lastIndexOf(Object o)"></a>6.lastIndexOf(Object o)</h3><p><strong>说明：</strong>返回容器内出现o的最后一个位置</p>
<p><strong>源码解释：</strong>从后向前遍历，得到第一个出现对象o的位置，不存在则返回-1</p>
<pre><code>public int lastIndexOf(Object o) {
    if (o == null) {
        for (int i = size-1; i &gt;= 0; i--)
            if (elementData[i]==null)
                return i;
    } else {
        for (int i = size-1; i &gt;= 0; i--)
            if (o.equals(elementData[i]))
                return i;
    }
    return -1;
}  
</code></pre><h3 id="7-clone"><a href="#7-clone" class="headerlink" title="7.clone()"></a>7.clone()</h3><p><strong>说明：</strong>返回此 ArrayList 实例的浅表副本。</p>
<p><strong>源码解释：</strong></p>
<pre><code>public Object clone() {
    try {
         // 调用父类(翻看源码可见是Object类)的clone方法得到一个ArrayList副本
        ArrayList&lt;?&gt; v = (ArrayList&lt;?&gt;) super.clone();
         // 调用Arrays类的copyOf，将ArrayList的elementData数组赋值给副本的elementData数组
        v.elementData = Arrays.copyOf(elementData, size);
        v.modCount = 0;
         // 返回副本v
        return v;
    } catch (CloneNotSupportedException e) {
        throw new InternalError(e);
    }
 }  
</code></pre><h3 id="8-toArray"><a href="#8-toArray" class="headerlink" title="8.toArray()"></a>8.toArray()</h3><p><strong>说明：</strong>ArrayList 实例转换为。</p>
<p><strong>源码解释：</strong>直接调用Arrays类的copyOf。</p>
<pre><code>public Object[] toArray() {
    return Arrays.copyOf(elementData, size);
}  
</code></pre><h3 id="9-toArray-T-a"><a href="#9-toArray-T-a" class="headerlink" title="9.toArray(T[] a)"></a>9.toArray(T[] a)</h3><p><strong>说明：</strong>将ArrayList里面的元素赋值到一个数组中去</p>
<p><strong>源码解释：</strong>如果a的长度小于ArrayList的长度，直接调用Arrays类的copyOf，返回一个比a数组长度要大的新数组，里面元素就是ArrayList里面的元素；如果a的长度比ArrayList的长度大，那么就调用System.arraycopy，将ArrayList的elementData数组赋值到a数组，然后把a数组的size位置赋值为空。</p>
<pre><code>public &lt;T&gt; T[] toArray(T[] a) {
    if (a.length &lt; size)
        // Make a new array of a&apos;s runtime type, but my contents:
        return (T[]) Arrays.copyOf(elementData, size, a.getClass());
    System.arraycopy(elementData, 0, a, 0, size);
    if (a.length &gt; size)
        a[size] = null;
    return a;
 }  
</code></pre><h3 id="10-rangeCheck-int-index"><a href="#10-rangeCheck-int-index" class="headerlink" title="10.rangeCheck(int index)"></a>10.rangeCheck(int index)</h3><p><strong>说明：</strong>测试index是否越界</p>
<p><strong>源码解释：</strong></p>
<pre><code>private void rangeCheck(int index) {
     // 如果下标超过ArrayList的数组长度
    if (index &gt;= size)
         // 抛出IndexOutOfBoundsException异常
        throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
}  
</code></pre><h3 id="11-get-int-index"><a href="#11-get-int-index" class="headerlink" title="11.get(int index)"></a>11.get(int index)</h3><p><strong>说明：</strong>获取index位置的元素</p>
<p><strong>源码解释：</strong>先检查是否越界，然后返回ArrayList的elementData数组index位置的元素。</p>
<pre><code>public E get(int index) {
     // 检查是否越界
    rangeCheck(index);
     // 返回ArrayList的elementData数组index位置的元素
    return elementData(index);
}  
</code></pre><h3 id="12-set-int-index-E-element"><a href="#12-set-int-index-E-element" class="headerlink" title="12.set(int index, E element)"></a>12.set(int index, E element)</h3><p><strong>说明：</strong>设置index位置的元素值了element，返回该位置的之前的值</p>
<p><strong>源码解释：</strong></p>
<pre><code>public E set(int index, E element) {
     // 检查是否越界  
    rangeCheck(index);
     // 调用elementData(index)获取到当前位置的值
    E oldValue = elementData(index);
     // 将element赋值到ArrayList的elementData数组的第index位置
    elementData[index] = element;
    return oldValue;
}  
</code></pre><h3 id="13-ensureCapacityInternal-int-minCapacity"><a href="#13-ensureCapacityInternal-int-minCapacity" class="headerlink" title="13.ensureCapacityInternal(int minCapacity)"></a>13.ensureCapacityInternal(int minCapacity)</h3><p><strong>说明：</strong>得到最小扩容量</p>
<p><strong>源码解释：</strong></p>
<pre><code>private void ensureCapacityInternal(int minCapacity) {
    if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
         // 获取默认的容量和传入参数的较大值
        minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);
    }
    ensureExplicitCapacity(minCapacity);
}
</code></pre><h3 id="14-ensureExplicitCapacity-int-minCapacity"><a href="#14-ensureExplicitCapacity-int-minCapacity" class="headerlink" title="14.ensureExplicitCapacity(int minCapacity)"></a>14.ensureExplicitCapacity(int minCapacity)</h3><p><strong>说明：</strong>判断是否需要扩容</p>
<p><strong>源码解释：</strong></p>
<pre><code>private void ensureExplicitCapacity(int minCapacity) {
    modCount++;
    // 如果最小需要空间比elementData的内存空间要大，则需要扩容
    if (minCapacity - elementData.length &gt; 0)
        grow(minCapacity);
} 
</code></pre><h3 id="15-grow-方法"><a href="#15-grow-方法" class="headerlink" title="15.grow()方法"></a>15.grow()方法</h3><p><strong>说明：</strong>帮助ArrayList动态扩容的核心方法</p>
<p><strong>源码解释：</strong></p>
<pre><code>// MAX_VALUE为231-1，MAX_ARRAY_SIZE 就是获取Java中int的最大限制，以防止越界  
private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;

private void grow(int minCapacity) {
    // 获取到ArrayList中elementData数组的内存空间长度
    int oldCapacity = elementData.length;
    // 扩容至原来的1.5倍
    int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);
    // 再判断一下新数组的容量够不够，够了就直接使用这个长度创建新数组， 
    // 不够就将数组长度设置为需要的长度
    if (newCapacity - minCapacity &lt; 0)
        newCapacity = minCapacity;
    // 判断有没超过最大限制
    if (newCapacity - MAX_ARRAY_SIZE &gt; 0)
        newCapacity = hugeCapacity(minCapacity);
    // 调用Arrays.copyOf方法将elementData数组指向新的内存空间时newCapacity的连续空间
    // 并将elementData的数据复制到新的内存空间
    elementData = Arrays.copyOf(elementData, newCapacity);
}  
</code></pre><h3 id="16-add-E-e"><a href="#16-add-E-e" class="headerlink" title="16.add(E e)"></a>16.add(E e)</h3><p><strong>说明：</strong>添加元素e</p>
<p><strong>源码解释：</strong></p>
<pre><code>public boolean add(E e) {
     // 扩容
    ensureCapacityInternal(size + 1);  
    // 将e赋值给elementData的size+1的位置。
    elementData[size++] = e;
    return true;
}  
</code></pre><h3 id="17-add-int-index-E-element"><a href="#17-add-int-index-E-element" class="headerlink" title="17.add(int index, E element)"></a>17.add(int index, E element)</h3><p><strong>说明：</strong>在ArrayList的index位置，添加元素element</p>
<p><strong>源码解释:</strong></p>
<pre><code>public void add(int index, E element) {
    // 判断index是否越界  
    rangeCheckForAdd(index);
     // 扩容
    ensureCapacityInternal(size + 1);  
     // 将elementData从index位置开始，复制到elementData的index+1开始的连续空间
    System.arraycopy(elementData, index, elementData, index + 1,
                     size - index);
     // 在elementData的index位置赋值element
    elementData[index] = element;
     // ArrayList的大小加一  
    size++;
}  
</code></pre><h3 id="18-remove-int-index"><a href="#18-remove-int-index" class="headerlink" title="18.remove(int index)"></a>18.remove(int index)</h3><p><strong>说明：</strong>在ArrayList的移除index位置的元素</p>
<p><strong>源码解释：</strong></p>
<pre><code>public E remove(int index) {
     // 判断是否越界  
    rangeCheck(index);
    modCount++;
     // 读取旧值  
    E oldValue = elementData(index);
     // 获取index位置开始到最后一个位置的个数
    int numMoved = size - index - 1;
    if (numMoved &gt; 0)
         // 将elementData数组index+1位置开始拷贝到elementData从index开始的空间
        System.arraycopy(elementData, index+1, elementData, index,
                         numMoved);
     // 使size-1 ，设置elementData的size位置为空，让GC来清理内存空间
    elementData[--size] = null; // clear to let GC do its work
    return oldValue;
}  
</code></pre><h3 id="19-remove-Object-o"><a href="#19-remove-Object-o" class="headerlink" title="19.remove(Object o)"></a>19.remove(Object o)</h3><p><strong>说明：</strong>在ArrayList的移除对象为O的元素，跟indexOf方法思想基本一致</p>
<p><strong>源码解释：</strong></p>
<pre><code>public boolean remove(Object o) {
    if (o == null) {
        for (int index = 0; index &lt; size; index++)
            if (elementData[index] == null) {
                fastRemove(index);
                return true;
            }
    } else {
        for (int index = 0; index &lt; size; index++)
            if (o.equals(elementData[index])) {
                fastRemove(index);
                return true;
            }
    }
    return false;
}  
</code></pre><h3 id="20-clear"><a href="#20-clear" class="headerlink" title="20.clear()"></a>20.clear()</h3><p><strong>说明：</strong>设置全部元素为null值，并设置size为0。</p>
<p><strong>源码解释：</strong>可见clear操作并不是从空间内删除，只是设置为null值，等待垃圾回收机制来回收而已，把size设置为0，以便我们不会浏览到null值的内存空间。</p>
<pre><code>public void clear() {
    modCount++;
    // clear to let GC do its work
    for (int i = 0; i &lt; size; i++)
        elementData[i] = null;
    size = 0;
}  
</code></pre><h3 id="21-addAll-Collection-lt-extends-E-gt-c"><a href="#21-addAll-Collection-lt-extends-E-gt-c" class="headerlink" title="21.addAll(Collection&lt;? extends E&gt; c)"></a>21.addAll(Collection&lt;? extends E&gt; c)</h3><p><strong>说明：</strong>将Collection c的全部元素添加到ArrayList中</p>
<p><strong>源码解释：</strong></p>
<pre><code>public boolean addAll(Collection&lt;? extends E&gt; c) {
     // 将c转换为数组a
    Object[] a = c.toArray();
     // 获取a占的内存空间长度赋值给numNew
    int numNew = a.length;
     // 扩容至size + numNew
    ensureCapacityInternal(size + numNew);  // Increments modCount
     // 将a的第0位开始拷贝至elementData的size位开始，拷贝长度为numNew
    System.arraycopy(a, 0, elementData, size, numNew);
     // 将size增加numNew  
    size += numNew;
     // 如果c为空，返回false，c不为空，返回true
    return numNew != 0;
}  
</code></pre><h3 id="22-addAll-int-index-Collection-lt-extends-E-gt-c"><a href="#22-addAll-int-index-Collection-lt-extends-E-gt-c" class="headerlink" title="22.addAll(int index, Collection&lt;? extends E&gt; c)"></a>22.addAll(int index, Collection&lt;? extends E&gt; c)</h3><p><strong>说明：</strong>从第index位开始，将c全部拷贝到ArrayList</p>
<p><strong>源码解释：</strong></p>
<pre><code>public boolean addAll(int index, Collection&lt;? extends E&gt; c) {
     // 判断index大于size或者是小于0,如果是，则抛出IndexOutOfBoundsException异常
    rangeCheckForAdd(index);
     // 将c转换为数组a
    Object[] a = c.toArray();
    int numNew = a.length;
     // 扩容至size + numNew
    ensureCapacityInternal(size + numNew);  // Increments modCount
      // 获取需要添加的个数
    int numMoved = size - index;
    if (numMoved &gt; 0)
        System.arraycopy(elementData, index, elementData, index + numNew,
                         numMoved);
    System.arraycopy(a, 0, elementData, index, numNew);
    size += numNew;
    return numNew != 0;
}  
</code></pre><h3 id="24-batchRemove-Collection-lt-gt-c-boolean-complement"><a href="#24-batchRemove-Collection-lt-gt-c-boolean-complement" class="headerlink" title="24.batchRemove(Collection&lt;?&gt; c, boolean complement)"></a>24.batchRemove(Collection&lt;?&gt; c, boolean complement)</h3><p><strong>说明：</strong>根据complement值，将ArrayList中包含c中元素的元素删除或者保留</p>
<p><strong>源码解释：</strong></p>
<pre><code>private boolean batchRemove(Collection&lt;?&gt; c, boolean complement) {
    final Object[] elementData = this.elementData;
     // 定义一个w，一个r，两个同时右移   
    int r = 0, w = 0;
    boolean modified = false;
    try {
         // r先右移
        for (; r &lt; size; r++)
              // 如果c中不包含elementData[r]这个元素
            if (c.contains(elementData[r]) == complement)
                  // 则直接将r位置的元素赋值给w位置的元素，w自增
                elementData[w++] = elementData[r];
    } finally {
        // 防止抛出异常导致上面r的右移过程没完成
        if (r != size) {
              // 将r未右移完成的位置的元素赋值给w右边位置的元素
            System.arraycopy(elementData, r,
                             elementData, w,
                             size - r);
              // 修改w值增加size-r
            w += size - r;
        }
        if (w != size) {
            // 如果有被覆盖掉的元素，则将w后面的元素都赋值为null
            for (int i = w; i &lt; size; i++)
                elementData[i] = null;
            modCount += size - w;
              // 修改size为w
            size = w;
            modified = true;
        }
    }
    return modified;
}  
</code></pre><h3 id="25-removeAll-Collection-lt-gt-c"><a href="#25-removeAll-Collection-lt-gt-c" class="headerlink" title="25.removeAll(Collection&lt;?&gt; c)"></a>25.removeAll(Collection&lt;?&gt; c)</h3><p><strong>说明：</strong>ArrayList移除c中的所有元素</p>
<p><strong>源码解释：</strong></p>
<pre><code>public boolean removeAll(Collection&lt;?&gt; c) {
     // 如果c为空，则抛出空指针异常
    Objects.requireNonNull(c);
     // 调用batchRemove移除c中的元素
    return batchRemove(c, false);
}  
</code></pre><h3 id="26-retainAll-Collection-lt-gt-c"><a href="#26-retainAll-Collection-lt-gt-c" class="headerlink" title="26.retainAll(Collection&lt;?&gt; c)"></a>26.retainAll(Collection&lt;?&gt; c)</h3><p><strong>说明：</strong>和removeAll相反，仅保留c中所有的元素</p>
<p><strong>源码解释：</strong></p>
<pre><code>public boolean retainAll(Collection&lt;?&gt; c) {
    Objects.requireNonNull(c);
     // 调用batchRemove保留c中的元素
    return batchRemove(c, true);
}  
</code></pre><h3 id="27-iterator"><a href="#27-iterator" class="headerlink" title="27.iterator()"></a>27.iterator()</h3><p><strong>说明：</strong>返回一个Iterator对象，Itr为ArrayList的一个内部类，其实现了Iterator<e>接口</e></p>
<pre><code>public Iterator&lt;E&gt; iterator() {
    return new Itr();
}  
</code></pre><h3 id="28-listIterator"><a href="#28-listIterator" class="headerlink" title="28.listIterator()"></a>28.listIterator()</h3><p><strong>说明：</strong>返回一个ListIterator对象，ListItr为ArrayList的一个内部类，其实现了ListIterator<e>  接口</e></p>
<p><strong>源码解释：</strong></p>
<pre><code>public ListIterator&lt;E&gt; listIterator() {
    return new ListItr(0);
}  
</code></pre><h3 id="29-listIterator-int-index"><a href="#29-listIterator-int-index" class="headerlink" title="29.listIterator(int index)"></a>29.listIterator(int index)</h3><p>说明：返回一个从index开始的ListIterator对象</p>
<p>源码解释：</p>
<pre><code>public ListIterator&lt;E&gt; listIterator(int index) {
    if (index &lt; 0 || index &gt; size)
        throw new IndexOutOfBoundsException(&quot;Index: &quot;+index);
    return new ListItr(index);
}  
</code></pre><h3 id="30-subList-int-fromIndex-int-toIndex"><a href="#30-subList-int-fromIndex-int-toIndex" class="headerlink" title="30.subList(int fromIndex, int toIndex)"></a>30.subList(int fromIndex, int toIndex)</h3><p><strong>说明：</strong>根据两个参数，获取到一个子序列</p>
<p><strong>源码解释：</strong></p>
<pre><code>public List&lt;E&gt; subList(int fromIndex, int toIndex) {
     // 检查异常
    subListRangeCheck(fromIndex, toIndex, size);
     // 调用SubList类的构造方法
    return new SubList(this, 0, fromIndex, toIndex);
}
</code></pre><h1 id="五、内部类"><a href="#五、内部类" class="headerlink" title="五、内部类"></a>五、内部类</h1><pre><code>(1)private class Itr implements Iterator&lt;E&gt;
(2)private class ListItr extends Itr implements ListIterator&lt;E&gt;
(3)private class SubList extends AbstractList&lt;E&gt; implements RandomAccess
(4)static final class ArrayListSpliterator&lt;E&gt; implements Spliterator&lt;E&gt;
</code></pre><p>ArrayList有四个内部类，</p>
<p>其中的Itr是实现了Iterator接口，同时重写了里面的hasNext()，next()，remove()等方法；</p>
<p>其中的ListItr继承Itr，实现了ListIterator接口，同时重写了hasPrevious()，nextIndex()，<br>previousIndex()，previous()，set(E e)，add(E e)等方法，所以这也可以看出了Iterator和ListIterator的区别，就是ListIterator在Iterator的基础上增加了添加对象，修改对象，逆向遍历等方法，这些是Iterator不能实现的。具体可以参考<a href="http://blog.csdn.net/a597926661/article/details/7679765。" target="_blank" rel="external">http://blog.csdn.net/a597926661/article/details/7679765。</a></p>
<p>其中的SubList继承AbstractList，实现了RandmAccess接口，类内部实现了对子序列的增删改查等方法，但它同时也充分利用了内部类的优点，就是共享ArrayList的全局变量，例如检查器变量modCount，数组elementData等，所以SubList进行的增删改查操作都是对ArrayList的数组进行的，并没有创建新的数组。</p>
<p>最后一个比较个人比较少接触，大家需要自行度娘。</p>
<h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><p>笔者技术真的是一般般，写这个为了加深理解的同时给害怕看源代码的朋友一点鼓励，所以笔者在写的过程中有查阅很多资料来努力减少错误，但是如有错漏之处，希望大神们指出，我会第一时间修改，以免误人子弟，也希望和笔者一样基础不够好的朋友不要畏惧看源码，源码看起来并不会很难，而且多看源代码会对Java更深刻的理解。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/Android学习-创建圆角的DialogActivity/" itemprop="url">
                  未命名
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T09:49:47+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          


          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/Android学习-创建圆角的DialogActivity/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/Android学习-创建圆角的DialogActivity/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          
		  
		 

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Android学习-创建圆角的DialogActivity"><a href="#Android学习-创建圆角的DialogActivity" class="headerlink" title="Android学习-创建圆角的DialogActivity"></a>Android学习-创建圆角的DialogActivity</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在安卓开发中我们多多少少都会使用到DialogActivity，但是系统自带的效果往往不尽如人意，一般都是下面这种效果，所以我们在使用时都会很蛋疼，最近在做项目需要用到圆角的DialogActivity，所以就参考网上资料，做了一个自己风格的圆角DialogActivit。</p>
<p><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post_MakeDialogActivitydefault.png" alt=""></p>
<h2 id="示例图"><a href="#示例图" class="headerlink" title="示例图"></a>示例图</h2><p>示例图如下，是不是很有苹果风呢？其实在这个基础上大家可以定制成自己风格的DialogActivity</p>
<p><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post_MakeDialogActivitychange.png" alt=""></p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>1.首先设置DialogActivity最外层的的layout背景为一个自定义背景，自定义背景如下:</p>
<p>dialog_theme.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; &gt;

    &lt;!-- 填充颜色 --&gt;
    &lt;solid android:color=&quot;#ffffffff&quot; /&gt;

    &lt;!-- 边框宽度 --&gt;
    &lt;!-- &lt;stroke android:width=&quot;3dp&quot; /&gt; --&gt;


    &lt;!-- 圆角半径 --&gt;
    &lt;corners android:radius=&quot;10dp&quot; /&gt;

    &lt;!-- 内边距 --&gt;
    &lt;padding
        android:bottom=&quot;13dp&quot;
        android:left=&quot;13dp&quot;
        android:right=&quot;13dp&quot;
        android:top=&quot;13dp&quot; /&gt;

&lt;/shape&gt;
</code></pre><p>2.然后自定义Activity的style为如下：</p>
<pre><code>&lt;style name=&quot;DialogTheme&quot; parent=&quot;@android:style/Theme.Dialog&quot;&gt;

    &lt;!-- 边框 --&gt;
    &lt;item name=&quot;android:windowFrame&quot;&gt;@null&lt;/item&gt;
    &lt;!-- 是否浮现在activity之上 --&gt;
    &lt;item name=&quot;android:windowIsFloating&quot;&gt;true&lt;/item&gt;
    &lt;!-- 半透明 --&gt;
    &lt;item name=&quot;android:windowIsTranslucent&quot;&gt;false&lt;/item&gt;
    &lt;!-- 无标题 --&gt;
    &lt;item name=&quot;android:windowNoTitle&quot;&gt;true&lt;/item&gt;
    &lt;!-- 背景透明 --&gt;
    &lt;item name=&quot;android:windowBackground&quot;&gt;@android:color/transparent&lt;/item&gt;
    &lt;!-- 模糊 --&gt;
    &lt;item name=&quot;android:backgroundDimEnabled&quot;&gt;false&lt;/item&gt;
&lt;/style&gt;
</code></pre><h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>1.Demo效果图</p>
<p><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post_MakeDialogActivitytest.gif" alt=""></p>
<p>2.github地址<br><a href="https://github.com/ryanlijianchang/DialogActivityDemo" target="_blank" rel="external">https://github.com/ryanlijianchang/DialogActivityDemo</a></p>
<p>3.下载地址<br><a href="http://download.csdn.net/detail/ljcitworld/9510717" target="_blank" rel="external">http://download.csdn.net/detail/ljcitworld/9510717</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/Android学习-手把手教学实现仿微信发带图片朋友圈的UI设计/" itemprop="url">
                  未命名
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T09:49:38+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          


          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/Android学习-手把手教学实现仿微信发带图片朋友圈的UI设计/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/Android学习-手把手教学实现仿微信发带图片朋友圈的UI设计/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          
		  
		 

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#Android学习-手把手教学实现仿微信发带图片朋友圈的UI设计#</p>
<h2 id="功能需求"><a href="#功能需求" class="headerlink" title="功能需求"></a>功能需求</h2><p>最近自己在开发一个社交APP，发送动态（类似朋友圈）是社交APP必备的一个功能，而自己在开发过程中也需要开发到这一个功能，但是在开发中遇到了一个问题，就是如何绘制一个类似朋友群那样动态添加图片，并加号随着自己的图片增加而后移这一个UI，而这篇小文就是教你如何制作一个仿朋友圈发带图朋友圈的UI设计。注意，这是UI设计，并不是实现图片上传功能。</p>
<p>当然，如果你想知道如何实现图片上传到服务器，请看我的另一篇文章：<a href="http://blog.csdn.net/ljcitworld/article/details/51670910" target="_blank" rel="external">Android学习-使用Async-Http实现图片压缩并上传功能</a>。个人水平有限，如有不足的地方，欢迎交流，勿喷。</p>
<h2 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h2><p>按照惯例，先上效果图。</p>
<p><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post-SendPhotoUI2.png" alt=""></p>
<h2 id="困难"><a href="#困难" class="headerlink" title="困难"></a>困难</h2><p>在自己开发学习过程中，主要遇到了两个难点：</p>
<ol>
<li>添加过多图片时，会出现OOM。</li>
<li>如何动态修改图片展示栏的高度。</li>
<li>加号如何伴随图片的增加而后移。</li>
<li>如何保证最多添加照片为9张。</li>
</ol>
<h2 id="难点解决"><a href="#难点解决" class="headerlink" title="难点解决"></a>难点解决</h2><h3 id="添加过多图片时，会出现OOM"><a href="#添加过多图片时，会出现OOM" class="headerlink" title="添加过多图片时，会出现OOM"></a>添加过多图片时，会出现OOM</h3><p>出现第一种情况的原因很简单，就是随着我们手机的像素越来越高，图片的大小也越来越大，我们普通的机拍出来照片至少也有1~2M，更不说像素高的手机。而对于一个安卓应用来说，由于手机设备的限制，一般应用使用的RAM不能超过某个设定值，不同产商默认值不太一样，一般常见的有16M，24M，32M,48M。所以一个Activity中加载几张高清原图，就会报Out Of Memory 错误，也就是所谓的OOM错误。所以知道了这个问题之后我们就很容易解决了，我们就可以先将图片压缩，然后再使用ImageView加载压缩后的图片即可。而我们这里是通过对图片的尺寸进行压缩实现图片的压缩，这里大概说一下。</p>
<ol>
<li><p>要对图片压缩，首先要先将BitmapFactory.Options中的inJustDecodeBounds设置为true。</p>
<pre><code>final BitmapFactory.Options options = new BitmapFactory.Options();
// 若要对图片进行压缩，必须先设置Option的inJustDecodeBounds为true
options.inJustDecodeBounds = true;
</code></pre></li>
<li><p>然后通过BitmapFactory中decodeFile方法来获取到照片的高度和宽度，这里只要存进一个图片地址即可。获取图片地址这里就不详讲了。</p>
<pre><code>BitmapFactory.decodeFile(pathName，options)
</code></pre></li>
</ol>
<ol>
<li><p>然后需要对BitmapFactory.Options中的inSampleSize根据你需要压缩比例进行设置，options.inSampleSize是图片的压缩比，例如原来大小是100 <em> 100，options.inSampleSize为1，则不变，options.inSampleSize为2，则压缩成50 </em> 50。而我这里是根据自己设置最低宽度和最低高度来获取inSampleSize的值：</p>
<pre><code>private static int calculateInSampleSize(BitmapFactory.Options options, int reqWidth, int reqHeight) {
    final int height = options.outHeight;
    final int width = options.outWidth;
    int inSampleSize = 1;
    if (height &gt; reqHeight || width &gt; reqWidth) {
        //首先获取原图高度和宽度的一半
        final int halfHeight = height / 2;
        final int halfWidth = width / 2;
        //循环，如果halfHeight和halfWidth同时大于最小宽度和最小高度时，inSampleSize乘2，
        //最后得到的宽或者高都是最接近最小宽度或者最小高度的
        while ((halfHeight / inSampleSize) &gt; reqHeight &amp;&amp; (halfWidth / inSampleSize) &gt; reqWidth) {
            inSampleSize *= 2;
        }
    }
    return inSampleSize;
}
</code></pre></li>
<li><p>获取到inSampleSize值之后，重新设置options.inJustDecodeBounds为false，不能修改option，调用BitmapFactory中的decodeFile方法即可获取到压缩后的照片，这样在加载图片时就可以避免OOM的出现了。</p>
<pre><code>options.inJustDecodeBounds = false;
// 根据options重新加载图片
Bitmap src = BitmapFactory.decodeFile(pathName, options);
</code></pre></li>
</ol>
<p>综上，我将按尺寸压缩照片的功能包装成BitmapUtil类，在使用时直接调用即可。</p>
<pre><code>public class BitmapUtils {

    private static int calculateInSampleSize(BitmapFactory.Options options, int reqWidth, int reqHeight) {
        final int height = options.outHeight;
        final int width = options.outWidth;
        int inSampleSize = 1;
        if (height &gt; reqHeight || width &gt; reqWidth) {
            final int halfHeight = height / 2;
            final int halfWidth = width / 2;
            while ((halfHeight / inSampleSize) &gt; reqHeight &amp;&amp; (halfWidth / inSampleSize) &gt; reqWidth) {
                inSampleSize *= 2;
            }
        }
        return inSampleSize;
    }

    /**
     * 根据Resources压缩图片
     * 
     * @param res
     * @param resId
     * @param reqWidth
     * @param reqHeight
     * @return
     */
    public static Bitmap decodeSampledBitmapFromResource(Resources res, int resId, int reqWidth, int reqHeight) {
        final BitmapFactory.Options options = new BitmapFactory.Options();
        options.inJustDecodeBounds = true;
        BitmapFactory.decodeResource(res, resId, options);
        options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);
        options.inJustDecodeBounds = false;
        Bitmap src = BitmapFactory.decodeResource(res, resId, options);
        return src;
    }

    /**
     * 根据地址压缩图片
     * 
     * @param pathName
     * @param reqWidth
     * @param reqHeight
     * @return
     */
    public static Bitmap decodeSampledBitmapFromFd(String pathName, int reqWidth, int reqHeight) {
        final BitmapFactory.Options options = new BitmapFactory.Options();
        options.inJustDecodeBounds = true;
        BitmapFactory.decodeFile(pathName, options);
        options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);
        options.inJustDecodeBounds = false;
        Bitmap src = BitmapFactory.decodeFile(pathName, options);
        return src;
    }
}
</code></pre><h3 id="如何动态修改图片展示栏的高度"><a href="#如何动态修改图片展示栏的高度" class="headerlink" title="如何动态修改图片展示栏的高度"></a>如何动态修改图片展示栏的高度</h3><p>如何动态修改图片展示栏的高度，首先我说一下我是使用GridView来实现图片栏的展示，所以我们可以在第一次加载GridView时可以获取到下图的参数，大家看图会容易理解一点。</p>
<ul>
<li>我们的照片如果只有一栏，则GridView的高度不变</li>
<li>如果照片有两栏，则高度设置为gridViewH * 2 - (gridViewH - imageViewH) / 2</li>
<li>如果有三栏，则GrideView的高度设置为gridViewH * 3 - (gridViewH - imageViewH)</li>
</ul>
<p><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post-SendPhotoUI3.png" alt=""></p>
<ol>
<li><p>我们在第一次加载GridView时记录GridView的高度GridViewH。</p>
<pre><code>LinearLayout.LayoutParams params =(android.widget.LinearLayout.LayoutParams) mGridView.getLayoutParams();

gridViewH = params.height;
</code></pre></li>
<li><p>同时记录ImageView的高度</p>
<pre><code>RelativeLayout.LayoutParams params = (android.widget.RelativeLayout.LayoutParams) holder.imageView
            .getLayoutParams();
imageViewH = params.height;
</code></pre></li>
<li><p>则上下的边距为</p>
<pre><code>(gridViewH - imageViewH) / 2
</code></pre></li>
<li><p>将它写成一个方法，在每次getView()方法中调用即可。</p>
<pre><code>private void setGridView() {
    LinearLayout.LayoutParams lp = (android.widget.LinearLayout.LayoutParams) mGridView.getLayoutParams();
    if (data.size() &lt; 4) {
        lp.height = gridViewH;
    } else if (data.size() &lt; 8) {
        lp.height = gridViewH * 2 - (gridViewH - imageViewH) / 2;
    } else {
        lp.height = gridViewH * 3 - (gridViewH - imageViewH);
    }
    mGridView.setLayoutParams(lp);
}
</code></pre></li>
</ol>
<h3 id="加号如何伴随图片的增加而后移"><a href="#加号如何伴随图片的增加而后移" class="headerlink" title="加号如何伴随图片的增加而后移"></a>加号如何伴随图片的增加而后移</h3><p>因为我的数据源是List<bitmap>，所以可以这么做：</bitmap></p>
<ul>
<li>当第一次加载时，List中只有一张加号的照片</li>
<li><p>当添加了照片之后，List先移除加号照片，再添加照片，最后再把加号照片添加进去</p>
<pre><code>data.remove(data.size() - 1);
Bitmap bp = BitmapFactory.decodeResource(getResources(), R.drawable.ic_addpic);
data.add(newBp);
data.add(bp);
//将路径设置为空，防止在手机休眠后返回Activity调用此方法时添加照片
photoPath = null;
adapter.notifyDataSetChanged();
</code></pre></li>
</ul>
<h3 id="如何保证最多添加照片为9张"><a href="#如何保证最多添加照片为9张" class="headerlink" title="如何保证最多添加照片为9张"></a>如何保证最多添加照片为9张</h3><p>这个问题只需要在每次添加之前判断数据源的大小是否为10（包括加号照片，大小就为10）。</p>
<pre><code>if (data.size() == 10) {
    Toast.makeText(MainActivity.this, &quot;图片数9张已满&quot;, Toast.LENGTH_SHORT).show();
} else {
    if (position == data.size() - 1) {
        Toast.makeText(MainActivity.this, &quot;添加图片&quot;, Toast.LENGTH_SHORT).show();
        // 选择图片
        Intent intent = new Intent(Intent.ACTION_PICK, null);
        intent.setDataAndType(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, &quot;image/*&quot;);
        startActivityForResult(intent, 0x1);
    } else {
        Toast.makeText(MainActivity.this, &quot;点击第&quot; + (position + 1) + &quot; 号图片&quot;, Toast.LENGTH_SHORT).show();
    }
}
</code></pre><h2 id="界面"><a href="#界面" class="headerlink" title="界面"></a>界面</h2><p>activity_main.xml</p>
<pre><code>&lt;ScrollView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:background=&quot;#F3F6F8&quot;
    android:orientation=&quot;vertical&quot; &gt;

    &lt;LinearLayout
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:orientation=&quot;vertical&quot; &gt;

        &lt;ImageView
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;1dp&quot;
            android:layout_marginTop=&quot;2dp&quot;
            android:src=&quot;#E4E3E3&quot; /&gt;

        &lt;EditText
            android:id=&quot;@+id/content_et&quot;
            android:layout_width=&quot;fill_parent&quot;
            android:layout_height=&quot;120dp&quot;
            android:background=&quot;#FFFFFF&quot;
            android:gravity=&quot;top&quot;
            android:hint=&quot;随手说出你此刻的心声...&quot;
            android:maxLength=&quot;500&quot;
            android:padding=&quot;5dp&quot;
            android:singleLine=&quot;false&quot;
            android:textColor=&quot;#000000&quot;
            android:textSize=&quot;20sp&quot; /&gt;

        &lt;ImageView
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;1dp&quot;
            android:src=&quot;#E4E3E3&quot; /&gt;

        &lt;ImageView
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;1dp&quot;
            android:layout_marginTop=&quot;10dp&quot;
            android:src=&quot;#E4E3E3&quot; /&gt;

        &lt;GridView
            android:id=&quot;@+id/gridView1&quot;
            android:layout_width=&quot;fill_parent&quot;
            android:layout_height=&quot;100dp&quot;
            android:background=&quot;#FFFFFF&quot;
            android:columnWidth=&quot;90dp&quot;
            android:gravity=&quot;center&quot;
            android:horizontalSpacing=&quot;5dp&quot;
            android:numColumns=&quot;4&quot;
            android:padding=&quot;10dp&quot;
            android:stretchMode=&quot;columnWidth&quot;
            android:verticalSpacing=&quot;5dp&quot; &gt;
        &lt;/GridView&gt;

        &lt;ImageView
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;1dp&quot;
            android:src=&quot;#E4E3E3&quot; /&gt;

        &lt;Button
            android:id=&quot;@+id/send_btn&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_gravity=&quot;center&quot;
            android:layout_marginLeft=&quot;35dp&quot;
            android:layout_marginRight=&quot;35dp&quot;
            android:layout_marginTop=&quot;20dp&quot;
            android:background=&quot;@drawable/send_btn_selector&quot;
            android:gravity=&quot;center&quot;
            android:text=&quot;发送&quot;
            android:textColor=&quot;#FFFFFF&quot;
            android:textSize=&quot;20sp&quot; /&gt;
    &lt;/LinearLayout&gt;

&lt;/ScrollView&gt;
</code></pre><p>griditem.xml</p>
<pre><code>&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:layout_width=&quot;80dp&quot;
    android:layout_height=&quot;80dp&quot;
    android:descendantFocusability=&quot;blocksDescendants&quot;
    android:gravity=&quot;center&quot; &gt;

    &lt;ImageView
        android:id=&quot;@+id/imageView1&quot;
        android:layout_width=&quot;80dp&quot;
        android:layout_height=&quot;80dp&quot;
        android:scaleType=&quot;centerCrop&quot;
        android:src=&quot;@drawable/ic_addpic&quot; /&gt;

&lt;/RelativeLayout&gt;
</code></pre><h2 id="Demo下载"><a href="#Demo下载" class="headerlink" title="Demo下载"></a>Demo下载</h2><p>Github:<a href="https://github.com/ryanlijianchang/TestUpload" target="_blank" rel="external">https://github.com/ryanlijianchang/TestUpload</a></p>
<p>CSDN: <a href="http://download.csdn.net/detail/ljcitworld/9549313" target="_blank" rel="external">http://download.csdn.net/detail/ljcitworld/9549313</a></p>
<h2 id="后话"><a href="#后话" class="headerlink" title="后话"></a>后话</h2><p>博主只是实现了这一个UI界面，我们开发过程中肯定要实现图片，文字的上传等，这里博主就不再详述了，大家可以看我的另一篇博文<a href="http://blog.csdn.net/ljcitworld/article/details/51670910" target="_blank" rel="external">Android学习-使用Async-Http实现图片压缩并上传功能</a>，就这个例子而言，大家如果需要上传多张照片，就可以在添加完照片之后将bitmap存起来，然后通过循环容器的大小，然后每一张图片再上传到服务器即可。还是那句话，<strong>个人能力有限，欢迎大家一起交流学习，我也会虚心接纳大家的指教，不喜勿喷。</strong></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://developer.android.com/training/displaying-bitmaps/load-bitmap.html" target="_blank" rel="external">Android Developer:Loading Large Bitmaps Efficiently</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/Android技能-创建Json文本及Json解析/" itemprop="url">
                  未命名
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T09:49:30+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          


          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/Android技能-创建Json文本及Json解析/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/Android技能-创建Json文本及Json解析/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          
		  
		 

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#Android技能-创建Json文本及Json解析 #<br>摘要：Json数据在安卓开发过程中是非常常见的，在请求服务器端数据的时候，服务器端返回的无非就是三种类型：HTML，XML，JSON。所以学习JSON对安卓程序员来说是非常重要的。</p>
<h2 id="什么是JSON"><a href="#什么是JSON" class="headerlink" title="什么是JSON"></a>什么是JSON</h2><p>JSON：JavaScript Object Notation。顾名思义，JSON数据是源自于JavaScript，学习过JavaScript（以下简称JS）的人都知道，我们在JS脚本里面创建对象时，都是以键值对的形式编写的。例如，我们在JS里面创建一个Json对象时是这么定义的：</p>
<pre><code>var person = {firstName:&quot;John&quot;, lastName:&quot;Doe&quot;, age:50, eyeColor:&quot;blue&quot;};
</code></pre><p>很容易看出，属性之间是通过逗号分隔开，键与值之间是通过双引号分隔开，而JSON数据也是如此。</p>
<h2 id="JSON的数据类型"><a href="#JSON的数据类型" class="headerlink" title="JSON的数据类型"></a>JSON的数据类型</h2><p>json一共有两种数据结构。</p>
<h3 id="JsonObject"><a href="#JsonObject" class="headerlink" title="JsonObject"></a>JsonObject</h3><p>一种是以 (key/value)对形式存在的无序的jsonObject对象。对象使用大括号括起来，属性之间使用逗号分隔开。</p>
<p><img src="http://images.cnitblog.com/blog/432441/201311/27202314-f6689071fd2444f18e2db818071ad990.gif" alt=""></p>
<p>例如：{“name”: “jack”}， 这就是一个最简单的json对象，对于这种数据格式，key值必须要是string类型，而对于value，则可以是string、number、object、array等数据类型。</p>
<h3 id="JsonArray"><a href="#JsonArray" class="headerlink" title="JsonArray"></a>JsonArray</h3><p>另一种数据格式就是有序的value的集合，这种形式被称为是JsonArray。数组是值的有序集合，值与值之间使用逗号分隔开，集合用中括号括起来。</p>
<p><img src="http://images.cnitblog.com/blog/432441/201311/27202539-5ecbee4dffaa4388998dd3118948ec48.gif" alt=""></p>
<h2 id="创建JSON文本"><a href="#创建JSON文本" class="headerlink" title="创建JSON文本"></a>创建JSON文本</h2><p>例如我们要创建以下类型的Jjson数据：</p>
<pre><code>{&quot;person&quot;:{&quot;name&quot;:&quot;zhangsan&quot;, &quot;phone&quot;:[&quot;123&quot;, &quot;456&quot;],&quot;address&quot;:&quot;guangdong&quot;}}
</code></pre><h3 id="使用JSONOject和JSONArray创建"><a href="#使用JSONOject和JSONArray创建" class="headerlink" title="使用JSONOject和JSONArray创建"></a>使用JSONOject和JSONArray创建</h3><pre><code>/**
 * 使用JsonObject和JsonArray创建JSON对象
 */
public void makeJson() {
    try {
        JSONObject object = new JSONObject();

        JSONObject person = new JSONObject();
        //名字
        person.put(&quot;name&quot;, &quot;zhangsan&quot;);
        //电话
        JSONArray phone = new JSONArray();
        phone.put(&quot;123&quot;).put(&quot;456&quot;);
        person.put(&quot;phone&quot;, phone);
        //地址
        person.put(&quot;address&quot;, &quot;guangdong&quot;);

        object.put(&quot;person&quot;, person);

        Log.i(&quot;JSON_LOG&quot;, object.toString());
    } catch (JSONException e) {
        e.printStackTrace();
    }
}
</code></pre><p>输出结果</p>
<p><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post-Json1.png" alt=""></p>
<h3 id="使用JsonStringer创建"><a href="#使用JsonStringer创建" class="headerlink" title="使用JsonStringer创建"></a>使用JsonStringer创建</h3><pre><code>/**
 * 通过JsonStringer创建JSON对象
 */
public void makeJsonStringer() {
    try {
        JSONStringer jsonText = new JSONStringer();
        // 首先是{，对象开始。object和endObject必须配对使用
        jsonText.object();

        jsonText.key(&quot;person&quot;);

        jsonText.object();

        jsonText.key(&quot;name&quot;);
        jsonText.value(&quot;zhangsan&quot;);

        jsonText.key(&quot;phone&quot;);
        // 键phone的值是数组。array和endArray必须配对使用
        jsonText.array();
        jsonText.value(&quot;123&quot;).value(&quot;456&quot;);
        jsonText.endArray();

        jsonText.key(&quot;address&quot;);
        jsonText.value(&quot;Guangdong&quot;);

        jsonText.endObject();

        jsonText.endObject();


        Log.i(&quot;JSON_LOG&quot;, jsonText.toString());
    } catch (JSONException ex) {
        throw new RuntimeException(ex);
    }
}
</code></pre><p>输出结果：</p>
<p><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post-Json2.png" alt=""></p>
<h2 id="JSON解析"><a href="#JSON解析" class="headerlink" title="JSON解析"></a>JSON解析</h2><h3 id="1-解析-“key”-“Object”-类型的"><a href="#1-解析-“key”-“Object”-类型的" class="headerlink" title="1. 解析{“key”, “Object”}类型的"></a>1. 解析{“key”, “Object”}类型的</h3><pre><code>{&quot;person&quot;:{&quot;name&quot;:&quot;zhangsan&quot;, &quot;phone&quot;:[&quot;123&quot;, &quot;456&quot;],&quot;address&quot;:&quot;guangdong&quot;}}
</code></pre><p>解析代码</p>
<pre><code>/**
 * JSON解析
 * @param json
 * @return
 */
public static String JsonToString(String json) {
    Person person = new Person();
    try {
        //获取到整个Json数据
        JSONObject object = new JSONObject(json);
        //解析最外层，获得person键对应的object值
        JSONObject personObject = object.getJSONObject(&quot;person&quot;);
        //解析object值里面的每一个属性
        person.setName(personObject.getString(&quot;name&quot;));
        //属性值是数组，则使用JSONArray获取
        JSONArray phoneArray = personObject.getJSONArray(&quot;phone&quot;);
        List&lt;String&gt; phone = new ArrayList&lt;&gt;();
        for (int i = 0; i &lt; phoneArray.length(); i++) {
            phone.add((String) phoneArray.get(i));
        }
        person.setPhone(phone);
        person.setAddress(personObject.getString(&quot;address&quot;));
    } catch (JSONException e) {
        e.printStackTrace();
    }
    return person.toString();
}
</code></pre><p>结果</p>
<p><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post-Json3.png" alt=""></p>
<h3 id="2-解析-“Object”-类型"><a href="#2-解析-“Object”-类型" class="headerlink" title="2. 解析{“Object”}类型"></a>2. 解析{“Object”}类型</h3><pre><code>{&quot;name&quot;:&quot;zhangsan&quot;, &quot;phone&quot;:[&quot;123&quot;, &quot;456&quot;],&quot;address&quot;:&quot;guangdong&quot;}
</code></pre><p>这么解析：</p>
<pre><code> /**
 * 解析单个对象的JSON数据
 * @param json
 * @return
 */
public static String JsonParse(String json) {
    Person person = new Person();
    try {
        JSONObject personObject = new JSONObject(json);
        //解析object值里面的每一个属性
        person.setName(personObject.getString(&quot;name&quot;));
        //属性值是数组，则使用JSONArray获取
        JSONArray phoneArray = personObject.getJSONArray(&quot;phone&quot;);
        List&lt;String&gt; phone = new ArrayList&lt;&gt;();
        for (int i = 0; i &lt; phoneArray.length(); i++) {
            phone.add((String) phoneArray.get(i));
        }
        person.setPhone(phone);
        person.setAddress(personObject.getString(&quot;address&quot;));
    } catch (JSONException e) {
        e.printStackTrace();
    }

    return person.toString();
}
</code></pre><h3 id="3-解析-“value”-类型"><a href="#3-解析-“value”-类型" class="headerlink" title="3. 解析{“value”}类型"></a>3. 解析{“value”}类型</h3><pre><code>[&quot;123&quot;, &quot;456&quot;, &quot;789&quot;];
</code></pre><p>解析方法：</p>
<pre><code>/**
 * 解析数组型的JSON数据
 * @param json
 * @return
 */
public static List&lt;String&gt; JsonParseToArray(String json){
    List&lt;String&gt; list = new ArrayList&lt;&gt;();
    try {
        JSONArray array = new JSONArray(json);
        for (int i=0; i&lt;array.length(); i++){
            list.add((String) array.get(i));
        }
    } catch (JSONException e) {
        e.printStackTrace();
    }
    return list;
}
</code></pre><h3 id="解析总结"><a href="#解析总结" class="headerlink" title="解析总结"></a>解析总结</h3><p>JSON解析无非就是通过JSONObject和JSONArray不断地对数据进行解析，归根结底每一种数据都是可以分解为以上的三种最基本的解析，所以大家只要掌握好JSONObject和JSONArray，即便再复杂的数据类型，大家也可以解析得得心应手。</p>
<h2 id="GSON"><a href="#GSON" class="headerlink" title="GSON"></a>GSON</h2><p>GSON是Google开发的开源的JAVA API，可以用于JSON的创建和JSON的解析。下面对GSON做一个最基本的介绍。更多了解 <a href="http://sites.google.com/site/gson/" target="_blank" rel="external">http://sites.google.com/site/gson/</a></p>
<p>首先需要下载GSON的jar包，自行度娘。</p>
<p>其次，我们使用GSON来创建JSON和解析JSON都要有相对应的JavaBean，所以GSON可以帮助我们更加简便地实现Bean和JSON的转换。</p>
<p>以下例子我们都是用Person类的JavaBean:</p>
<pre><code>public class Person {
    private String name;
    private List&lt;String&gt; phone;
    private String address;

    public Person() {

    }

    public Person(String name, List&lt;String&gt; phone, String address) {
        this.name = name;
        this.phone = phone;
        this.address = address;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public List&lt;String&gt; getPhone() {
        return phone;
    }

    public void setPhone(List&lt;String&gt; phone) {
        this.phone = phone;
    }

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

    @Override
    public String toString() {
        return &quot;Person{&quot; +
                &quot;name=&apos;&quot; + name + &apos;\&apos;&apos; +
                &quot;, phone=&quot; + phone +
                &quot;, address=&apos;&quot; + address + &apos;\&apos;&apos; +
                &apos;}&apos;;
    }
}
</code></pre><h3 id="Bean转换为JSON"><a href="#Bean转换为JSON" class="headerlink" title="Bean转换为JSON"></a>Bean转换为JSON</h3><pre><code>/**
 * GSON转换为JSON
 *
 * @return json
 */
public String beanToJson() {

    //赋值给一个person实例
    List&lt;String&gt; phone = new ArrayList&lt;&gt;();
    phone.add(&quot;123&quot;);
    phone.add(&quot;456&quot;);
    Person person = new Person(&quot;jack&quot;, phone, &quot;Guangzhou&quot;);

    //实例化GSON
    Gson gson = new Gson();
    //调用gson.toJson将Bean转为JSON
    String json = gson.toJson(person);
    return json;
}
</code></pre><h3 id="JSON转换为Bean"><a href="#JSON转换为Bean" class="headerlink" title="JSON转换为Bean"></a>JSON转换为Bean</h3><pre><code>/**
 * JSON转换为Bean
 * @param json
 * @return
 */
public String jsonToBean(String json) {
    Person person = new Person();
    Gson gson = new Gson();
    //调用gson.fromJson将json转为bean
    person = gson.fromJson(json, Person.class);
    return person.toString();
}
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/Android学习-简易ViewPager的使用教程与Demo演示/" itemprop="url">
                  未命名
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T09:49:03+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          


          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/Android学习-简易ViewPager的使用教程与Demo演示/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/Android学习-简易ViewPager的使用教程与Demo演示/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          
		  
		 

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#Android学习-简易ViewPager的使用教程与Demo演示<br>摘要：最近在项目开发中使用到了ViewPager，结合自己几天下来的学习，总结一下ViewPager的使用方法以及实现过程。</p>
<p>##实例效果<br><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post-HowToUseVP-show.gif" alt=""></p>
<p>##前言<br>这是谷歌<a href="http://www.android-doc.com/reference/android/support/v4/view/ViewPager.html" target="_blank" rel="external">官方文档</a>给我们提供的一个兼容包里面的类，它说我们的ViewPager通常是配合Fragment使用的，而官方是提供了FragmentPagerAdapter和FragmentStatePagerAdapter两种方便我们将ViewPager和Fragment配合使用。下面我们主要讲ViewPager+Fragment的使用。<br><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post-HowToUseVP-guanfang.png" alt=""></p>
<p>##Demo剖析</p>
<p>这个Demo的难点主要在以下三部分，那么我们下面就对这三个部分进行剖析。</p>
<p>###一、top_bar部分</p>
<p>这部分我们只需要设置一个外布局为LinearLayout（注意！这个Layout的高度一定不能为match_parent，只能为wrap_content，因为如果你这里使用了match_parent的话，那么就会遮挡了下面的ViewPager控件，详见我的main.xml布局文件以及top_bar.xml 布局文件，我的主布局为了代码布局清晰，所以通过定义了top_bar的layout，然后通过引入即可。）</p>
<p>###二、下标部分</p>
<p>下标部分我们是通过一个imageview来实现。将此ImageView的背景设为一个蓝色的点九图，然后再逻辑文件中设置它的长度以及在滑动时的位置变化即可。</p>
<p>设置滑动条的宽度</p>
<pre><code> /**
  * 设置滑动条的宽度为屏幕的1/3(根据Tab的个数而定)
  */
private void initTabLineWidth() {
    DisplayMetrics dpMetrics = new DisplayMetrics();
    getWindow().getWindowManager().getDefaultDisplay().getMetrics(dpMetrics);
    screenWidth = dpMetrics.widthPixels;
    LinearLayout.LayoutParams lp = (LinearLayout.LayoutParams) tab.getLayoutParams();
    lp.width = screenWidth / 3;
    tab.setLayoutParams(lp);
}
</code></pre><p>在onPagerScrolled方法中设置滑动条的位置变化</p>
<pre><code> @Override
 public void onPageScrolled(int position, float offset,
                                   int offsetPixels) {
     LinearLayout.LayoutParams lp = (LinearLayout.LayoutParams) tablineIv.getLayoutParams();
    Log.i(&quot;mOffset&quot;, &quot;offset:&quot; + offset + &quot;,position:&quot; + position);

    if (currentIndex == 0 &amp;&amp; position == 0)// 0-&gt;1
    {
        lp.leftMargin = (int) (offset * (screenWidth * 1.0 / 3) + currentIndex
                        * (screenWidth / 3));
    } else if (currentIndex == 1 &amp;&amp; position == 0) // 1-&gt;0
    {
        lp.leftMargin = (int) (-(1 - offset) * (screenWidth * 1.0 / 3) + currentIndex * (screenWidth / 3));
    } else if (currentIndex == 1 &amp;&amp; position == 1) // 1-&gt;2
    {
        lp.leftMargin = (int) (offset * (screenWidth * 1.0 / 3) + currentIndex
                        * (screenWidth / 3));
    } else if (currentIndex == 2 &amp;&amp; position == 1) // 2-&gt;1
    {
        lp.leftMargin = (int) (-(1 - offset) * (screenWidth * 1.0 / 3) + currentIndex * (screenWidth / 3));
    }
    tablineIv.setLayoutParams(lp);
}
</code></pre><p>###三、ViewPager实现部分</p>
<p>ViewPager的实现主要通过以下步骤：</p>
<ol>
<li><p>把包含的Fragement存放到一个容器List里面去</p>
</li>
<li><p>创建一个FragmentPagerAdapter</p>
</li>
<li><p>为ViewPager绑定此FragmentPagerAdapter</p>
</li>
<li><p>ViewPager设置默认当前的项</p>
</li>
<li><p>ViewPager设置监听器，需要重写onPageScrollStateChanged，onPageScrolled，onPageSelected三个方法  </p>
</li>
</ol>
<p>##代码实现</p>
<p>###一、界面部分<br>在界面部分，需要将我们的顶部的内容和ViewPager分开。如下我们将top_bar内容和ViewPager分开。</p>
<p>main.xml</p>
<pre><code>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:orientation=&quot;vertical&quot;&gt;

    &lt;!-- 顶部的内容 --&gt;
    &lt;include layout=&quot;@layout/top_bar&quot; /&gt;

    &lt;!-- ViewPager --&gt;
    &lt;android.support.v4.view.ViewPager
        android:id=&quot;@+id/viewpager&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;0dp&quot;
        android:layout_weight=&quot;1&quot; &gt;
    &lt;/android.support.v4.view.ViewPager&gt;

&lt;/LinearLayout&gt;
</code></pre><p>top_bar.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
    &lt;!--注意最外层布局的高度不能使用match_parent，不然将会遮挡了ViewPager部分--&gt;
    &lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;wrap_content&quot;
    android:orientation=&quot;vertical&quot;&gt;


    &lt;LinearLayout
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:baselineAligned=&quot;false&quot;
        android:orientation=&quot;horizontal&quot;&gt;

        &lt;TextView
            android:id=&quot;@+id/mainTv&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;50dp&quot;
            android:layout_weight=&quot;1&quot;
            android:gravity=&quot;center&quot;
            android:text=&quot;首页&quot;
            android:textColor=&quot;#0000FF&quot;
            android:textSize=&quot;18dp&quot; /&gt;

        &lt;TextView
            android:id=&quot;@+id/momentTv&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;50dp&quot;
            android:layout_weight=&quot;1&quot;
            android:gravity=&quot;center&quot;
            android:text=&quot;朋友圈&quot;
            android:textColor=&quot;@android:color/black&quot;
            android:textSize=&quot;18dp&quot; /&gt;

        &lt;TextView
            android:id=&quot;@+id/settingTv&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;50dp&quot;
            android:layout_weight=&quot;1&quot;
            android:gravity=&quot;center&quot;
            android:text=&quot;设置&quot;
            android:textColor=&quot;@android:color/black&quot;
            android:textSize=&quot;18dp&quot; /&gt;


    &lt;/LinearLayout&gt;

    &lt;ImageView
        android:id=&quot;@+id/iv_tabline&quot;
        android:layout_width=&quot;200dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:contentDescription=&quot;tab&quot;
        android:background=&quot;@drawable/tab&quot; &gt;
    &lt;/ImageView&gt;

&lt;/LinearLayout&gt;
</code></pre><p>还有我们的三个Fragment界面，基本一致。</p>
<p>fragment_main.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;&gt;

    &lt;TextView
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot;
        android:gravity=&quot;center&quot;
        android:text=&quot;首页&quot;/&gt;

&lt;/LinearLayout&gt;
</code></pre><p>fragment_moment.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;&gt;

    &lt;TextView
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot;
        android:gravity=&quot;center&quot;
        android:text=&quot;朋友圈&quot;/&gt;

&lt;/LinearLayout&gt;
</code></pre><p>fragment_setting.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;&gt;

    &lt;TextView
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot;
        android:gravity=&quot;center&quot;
        android:text=&quot;设置&quot;/&gt;

&lt;/LinearLayout&gt;
</code></pre><p>###二、逻辑代码<br>MainActivity.java</p>
<pre><code>package com.example.ryan.viewpagerdemo;

import android.graphics.Color;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.view.ViewPager;
import android.support.v4.view.ViewPager.OnPageChangeListener;
import android.util.DisplayMetrics;
import android.util.Log;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.TextView;
import java.util.ArrayList;
import java.util.List;

/**
 * MainActivity需要继承FragmentActivity
 */
public class MainActivity extends FragmentActivity {
    private ViewPager viewPager;
    private List&lt;Fragment&gt; mFragmentList = new ArrayList&lt;Fragment&gt;();
    private FragmentAdapter mFragmentAdapter;

    //Tab显示内容TextView
    private TextView mainTv, momentTv, settingTv;
    //Tab的那个引导线
    private ImageView tablineIv;

    //三个Fragment页面
    private MainFragment mainFg;
    private MomentFragment momentFg;
    private SettingFragment settingFg;

    //ViewPager的当前选中页
    private int currentIndex;

    //屏幕的宽度
    private int screenWidth;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        findById();
        init();
        initTabLineWidth();

    }

    /**
     * 找到控件ID
     */
    private void findById() {
        mainTv = (TextView) this.findViewById(R.id.mainTv);
        momentTv = (TextView) this.findViewById(R.id.momentTv);
        settingTv = (TextView) this.findViewById(R.id.settingTv);
        tablineIv = (ImageView) this.findViewById(R.id.iv_tabline);
        viewPager = (ViewPager) this.findViewById(R.id.viewpager);
    }

    /**
     * 初始化ViewPager和设置监听器
     */
    private void init() {
        mainFg = new MainFragment();
        momentFg = new MomentFragment();
        settingFg = new SettingFragment();
        //将三个页面添加到容器里面
        mFragmentList.add(mainFg);
        mFragmentList.add(momentFg);
        mFragmentList.add(settingFg);

        //重写一个FragmentAdapter继承FragmentPagerAdapter，需要FragmentManager和存放页面的容器过去
        mFragmentAdapter = new FragmentAdapter(this.getSupportFragmentManager(), mFragmentList);
        //ViewPager绑定监听器
        viewPager.setAdapter(mFragmentAdapter);
        //ViewPager设置默认当前的项
        viewPager.setCurrentItem(0);
        //ViewPager设置监听器，需要重写onPageScrollStateChanged，onPageScrolled，onPageSelected三个方法
        viewPager.addOnPageChangeListener(new OnPageChangeListener() {

        /**
         * state滑动中的状态 有三种状态（0，1，2） 1：正在滑动 2：滑动完毕 0：什么都没做。
         * 三个方法的执行顺序为：用手指拖动翻页时，最先执行一遍onPageScrollStateChanged（1），
         * 然后不断执行onPageScrolled，放手指的时候，直接立即执行一次onPageScrollStateChanged（2），
         * 然后立即执行一次onPageSelected，然后再不断执行onPageScrolled，
         * 最后执行一次onPageScrollStateChanged（0）。
         */

        /**
         * state滑动中的状态 有三种状态（0，1，2） 1：正在滑动 2：滑动完毕 0：什么都没做。
         */
        @Override
        public void onPageScrollStateChanged(int state) {
            Log.i(&quot;PageScroll：&quot;, &quot;onPageScrollStateChanged&quot; + &quot;:&quot; + state);
        }

        /**
         * position :当前页面，及你点击滑动的页面 offset:当前页面偏移的百分比
         * offsetPixels:当前页面偏移的像素位置
         */
        @Override
        public void onPageScrolled(int position, float offset,
                                   int offsetPixels) {
            LinearLayout.LayoutParams lp = (LinearLayout.LayoutParams) tablineIv.getLayoutParams();
            Log.i(&quot;mOffset&quot;, &quot;offset:&quot; + offset + &quot;,position:&quot; + position);
            /**
              * 利用currentIndex(当前所在页面)和position(下一个页面)以及offset来
              * 设置mTabLineIv的左边距 滑动场景：
                 * 记3个页面,
                 * 从左到右分别为0,1,2
                 * 0-&gt;1; 1-&gt;2; 2-&gt;1; 1-&gt;0
                 */
                if (currentIndex == 0 &amp;&amp; position == 0)// 0-&gt;1
                {
                    lp.leftMargin = (int) (offset * (screenWidth * 1.0 / 3) +     currentIndex
                            * (screenWidth / 3));

                } else if (currentIndex == 1 &amp;&amp; position == 0) // 1-&gt;0
                {
                    lp.leftMargin = (int) (-(1 - offset)
                            * (screenWidth * 1.0 / 3) + currentIndex
                            * (screenWidth / 3));

                } else if (currentIndex == 1 &amp;&amp; position == 1) // 1-&gt;2
                {
                    lp.leftMargin = (int) (offset * (screenWidth * 1.0 / 3) +     currentIndex
                            * (screenWidth / 3));
                } else if (currentIndex == 2 &amp;&amp; position == 1) // 2-&gt;1
                {
                       lp.leftMargin = (int) (-(1 - offset)
                            * (screenWidth * 1.0 / 3) + currentIndex
                            * (screenWidth / 3));
                }
                tablineIv.setLayoutParams(lp);
            }

            /**
             * 将当前选择的页面的标题设置字体颜色为蓝色
             */
            @Override
            public void onPageSelected(int position) {
                Log.i(&quot;PageScroll：&quot;, &quot;onPageSelected&quot; + &quot;:&quot; + position);
                resetTextView();
                switch (position) {
                    case 0:
                        mainTv.setTextColor(Color.BLUE);
                        break;
                    case 1:
                        momentTv.setTextColor(Color.BLUE);
                        break;
                    case 2:
                        settingTv.setTextColor(Color.BLUE);
                        break;
                }
                currentIndex = position;
            }
        });

    }

    /**
     * 设置滑动条的宽度为屏幕的1/3(根据Tab的个数而定)
     */
    private void initTabLineWidth() {
           DisplayMetrics dpMetrics = new DisplayMetrics();
        getWindow().getWindowManager().getDefaultDisplay().getMetrics(dpMetrics);
        screenWidth = dpMetrics.widthPixels;
        LinearLayout.LayoutParams lp = (LinearLayout.LayoutParam    tablineIv.getLayoutParams();
        lp.width = screenWidth / 3;
        tablineIv.setLayoutParams(lp);
    }

    /**
     * 重置颜色
     */
    private void resetTextView() {
        mainTv.setTextColor(Color.BLACK);
        momentTv.setTextColor(Color.BLACK);
        settingTv.setTextColor(Color.BLACK);
    }
}
</code></pre><p>FragmentAdapter.java</p>
<pre><code>package com.example.ryan.viewpagerdemo;

import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentPagerAdapter;

import java.util.ArrayList;
import java.util.List;

public class FragmentAdapter extends FragmentPagerAdapter {

    List&lt;Fragment&gt; fragmentList = new ArrayList&lt;Fragment&gt;();
    public FragmentAdapter(FragmentManager fm,List&lt;Fragment&gt; fragmentList) {
        super(fm);
        this.fragmentList = fragmentList;
    }

    @Override
    public Fragment getItem(int position) {
        return fragmentList.get(position);
    }

    @Override
    public int getCount() {
        return fragmentList.size();
    }

}
</code></pre><p>##源码下载<br>ps：此Demo是使用Android Studio编写的，请使用AS打开。</p>
<p>下载地址：<a href="http://download.csdn.net/detail/ljcitworld/9474994" target="_blank" rel="external">http://download.csdn.net/detail/ljcitworld/9474994</a></p>
<p>Github地址：<a href="https://github.com/ryanlijianchang/ViewPagerDemo" target="_blank" rel="external">https://github.com/ryanlijianchang/ViewPagerDemo</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/12/写给大三的自己/" itemprop="url">
                  写给大三的自己
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-12T22:10:54+08:00" content="2016-05-12">
              2016-05-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/生活/" itemprop="url" rel="index">
                    <span itemprop="name">生活</span>
                  </a>
                </span>

                
                

              
            </span>
          


          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/12/写给大三的自己/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/12/写给大三的自己/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          
		  
		 

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post-WritingToDaSan8.jpg" alt=""></p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/05/12/写给大三的自己/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/17/安卓开发者技能之-点九图的制作/" itemprop="url">
                  安卓开发者必备技能之-点九图的制作
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-17T21:37:26+08:00" content="2016-03-17">
              2016-03-17
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                

              
            </span>
          


          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/03/17/安卓开发者技能之-点九图的制作/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/17/安卓开发者技能之-点九图的制作/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          
		  
		 

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>##前言<br>很多安卓开发者觉得UI制作都是美工的事情，自己只需要完成控件的摆放和功能的实现。但是很多时候，在我们自己写一些小应用或者小Demo的时候，并不会有个美工在我们身边，而点九图之于我们安卓开发者来说再常见不过了，所以这个技能我们掌握了也是非常实用的。以下博文只是带大家入门使用点九图，不敢在美工设计师面前班门弄斧，大神请直接略过。</p>
<p>##点九图<br>随着智能手机的发展,我们的应用需要适应不同屏幕尺寸的手机，同一幅界面会在随着手机(或平板电脑)中的方向传感器的参数不同而改变显示的方向,在界面改变方向后,界面上的图形会因为长宽的变化而产生拉伸,造成图形的失真变形。</p>
<p>而点九（即.9），是andriod平台的应用软件开发里的一种特殊的图片形式，文件扩展名为：.9.png，正是为了解决我们的图片在不同尺寸屏幕上显示失真而应运而生的一种格式。</p>
<center><img src="http://7xrwkh.com1.z0.glb.clouddn.com/post-dianjiu-1.jpg" alt=""></center>

<center>普通拉伸和点九拉伸效果对比</center>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/03/17/安卓开发者技能之-点九图的制作/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/16/小白独立搭建博客-Github-Pages和Hexo简明教程/" itemprop="url">
                  小白独立搭建博客-Github-Pages和Hexo简明教程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-16T01:41:40+08:00" content="2016-03-16">
              2016-03-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Hexo/" itemprop="url" rel="index">
                    <span itemprop="name">Hexo</span>
                  </a>
                </span>

                
                

              
            </span>
          


          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/03/16/小白独立搭建博客-Github-Pages和Hexo简明教程/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/16/小白独立搭建博客-Github-Pages和Hexo简明教程/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          
		  
		 

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post-GithubAndHexoyhbg.jpg" alt=""></p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/03/16/小白独立搭建博客-Github-Pages和Hexo简明教程/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/12/欢迎来到我的博客/" itemprop="url">
                  Welcome to my blog
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-12T20:07:40+08:00" content="2016-03-12">
              2016-03-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/life/" itemprop="url" rel="index">
                    <span itemprop="name">life</span>
                  </a>
                </span>

                
                

              
            </span>
          


          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/03/12/欢迎来到我的博客/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/12/欢迎来到我的博客/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          
		  
		 

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><img src="http://7xrwkh.com1.z0.glb.clouddn.com/Post-WelcomeToMyBlogback.jpg" alt=""></p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/03/12/欢迎来到我的博客/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          









        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="Ryane Lee" />
          <p class="site-author-name" itemprop="name">Ryane Lee</p>
          <p class="site-description motion-element" itemprop="description">Android Developer</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">9</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>
		
		
          <div class="feed-link motion-element"   style="background-color: rgb(255,91,255);">
            <a  style="color: white;" href='javascript:(       
												function go() {        
													function c() {        
														var e = document.createElement("link");        
														e.setAttribute("type", "text/css");        
														e.setAttribute("rel", "stylesheet");        
														e.setAttribute("href", f);        
														e.setAttribute("class", l);        
														document.body.appendChild(e)    }     
													function h() {        
														var e = document.getElementsByClassName(l);        
														for (var t = 0; t < e.length; t++) {            
															document.body.removeChild(e[t])        
															}    
													}     
													function p() {        
														var e = document.createElement("div");        
														e.setAttribute("class", a);        
														document.body.appendChild(e);        
														setTimeout(function() {            
															document.body.removeChild(e)        
														}, 100)    
													}     
													function d(e) {        
														return {            
															height : e.offsetHeight,            
															width : e.offsetWidth        
														}    
													}     
													function v(i) {        
														var s = d(i);        
														return s.height > e && s.height < n && s.width > t && s.width < r    
													}     
													function m(e) {        
														var t = e;        
														var n = 0;        
														while (!!t) {            
															n += t.offsetTop;            
															t = t.offsetParent        
														}        
														return n    
													}     
													function g() {        
														var e = document.documentElement;        
														if (!!window.innerWidth) {            
															return window.innerHeight        
														} else if (e && !isNaN(e.clientHeight)) { 
															return e.clientHeight        
														}        
														return 0    
													}     
													function y() {        
														if (window.pageYOffset) {            
															return window.pageYOffset        
														}        
														return Math.max(document.documentElement.scrollTop, document.body.scrollTop)    
													}     
													function E(e) {        
														var t = m(e);        
														return t >= w && t <= b + w    
													}     
													var songs = [ "http://7xs0af.com1.z0.glb.clouddn.com/Pure-River-Flows-In-You.mp3",
																  "http://7xs0af.com1.z0.glb.clouddn.com/Pure-Quiet.mp3",
																  "http://7xs0af.com1.z0.glb.clouddn.com/Pure-Forever.mp3",
																  "http://7xs0af.com1.z0.glb.clouddn.com/Pure-Faylinn.mp3",
																  "http://7xs0af.com1.z0.glb.clouddn.com/Pure-A-Little-Story.mp3"];    																  
													function S() {        
														var e = document.getElementById("audio_element_id");        
														if(e != null){            
															var index = parseInt(e.getAttribute("curSongIndex"));            
															if(index > songs.length - 2) {                
																index = 0;            
															} else {                
																index++;            
															}            
															e.setAttribute("curSongIndex", index);            
															N();        
														}        
														e.src = i;        
														e.play()    
													}     
													function x(e) {        
														e.className += " " + s + " " + o    
													}     
													function T(e) {        
														e.className += " " + s + " " + u[Math.floor(Math.random() * u.length)]    
													}     
													function N() {        
														var e = document.getElementsByClassName(s);        
														var t = new RegExp("\\b" + s + "\\b");        
														for (var n = 0; n < e.length; ) {            
															e[n].className = e[n].className.replace(t, "")        
														}    
													}    
													function initAudioEle() {        
														var e = document.getElementById("audio_element_id");        
														if(e === null){            
															e = document.createElement("audio");            
															e.setAttribute("class", l);            
															e.setAttribute("curSongIndex", 0);            
															e.id = "audio_element_id";            
															e.loop = false;            
															e.bgcolor = 0;            
															e.addEventListener("canplay", function() {            
																setTimeout(function() {                
																	x(k)            
																}, 500);            
																setTimeout(function() {                
																	N();                
																	p();                
																	for (var e = 0; e < O.length; e++) {
																		T(O[e])                
																	}            
																}, 15500)       
															}, true);        
															e.addEventListener("ended", function() {
																N();            
																h();            
																go();        
															}, true);        
															e.innerHTML = " <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p> <p>";        
															document.body.appendChild(e);        
														}    
													}        
													initAudioEle();    
													var e = 30;    
													var t = 30;    
													var n = 350;    
													var r = 350;    
													var curSongIndex = parseInt(document.getElementById("audio_element_id").getAttribute("curSongIndex"));    
													var i = songs[curSongIndex];        
													var s = "mw-harlem_shake_me";    
													var o = "im_first";    
													var u = ["im_drunk", "im_baked", "im_trippin", "im_blown"];    
													var a = "mw-strobe_light";    
													var f = "//";        
													var l = "mw_added_css";    var b = g();    
													var w = y();    
													var C = document.getElementsByTagName("*");    
													var k = null;    
													for (var L = 0; L < C.length; L++) {        
														var A = C[L];        
														if (v(A)) {            
															if (E(A)) {                
																k = A;                
																break            
															}       
														}   
													}    
													if (A === null) {        
														console.warn("Could not find a node of the right size. Please try a different page.");        
														return    
													}    
													c();    
													S();    
													var O = [];    
													for (var L = 0; L < C.length; L++) {        
														var A = C[L];        
														if (v(A)) {            
															O.push(A)        
														}    
													}    
												})()'>
              Music
            </a>
          </div>
        

        
          <div class="feed-link motion-element"   style="background-color: rgb(56,183,234);">
            <a  style="color: white;"  href='javascript:(       
												function go() {        
													function c() {        
														var e = document.createElement("link");        
														e.setAttribute("type", "text/css");        
														e.setAttribute("rel", "stylesheet");        
														e.setAttribute("href", f);        
														e.setAttribute("class", l);        
														document.body.appendChild(e)    }     
													function h() {        
														var e = document.getElementsByClassName(l);        
														for (var t = 0; t < e.length; t++) {            
															document.body.removeChild(e[t])        
															}    
													}     
													function p() {        
														var e = document.createElement("div");        
														e.setAttribute("class", a);        
														document.body.appendChild(e);        
														setTimeout(function() {            
															document.body.removeChild(e)        
														}, 100)    
													}     
													function d(e) {        
														return {            
															height : e.offsetHeight,            
															width : e.offsetWidth        
														}    
													}     
													function v(i) {        
														var s = d(i);        
														return s.height > e && s.height < n && s.width > t && s.width < r    
													}     
													function m(e) {        
														var t = e;        
														var n = 0;        
														while (!!t) {            
															n += t.offsetTop;            
															t = t.offsetParent        
														}        
														return n    
													}     
													function g() {        
														var e = document.documentElement;        
														if (!!window.innerWidth) {            
															return window.innerHeight        
														} else if (e && !isNaN(e.clientHeight)) { 
															return e.clientHeight        
														}        
														return 0    
													}     
													function y() {        
														if (window.pageYOffset) {            
															return window.pageYOffset        
														}        
														return Math.max(document.documentElement.scrollTop, document.body.scrollTop)    
													}     
													function E(e) {        
														var t = m(e);        
														return t >= w && t <= b + w    
													}     
													var songs = [ "http://7xs0af.com1.z0.glb.clouddn.com/High-Die-Young.mp3",
																  "http://7xs0af.com1.z0.glb.clouddn.com/High-I-Want-You-to-Know.mp3",
																  "http://7xs0af.com1.z0.glb.clouddn.com/High-Summer-Vibe.mp3",
																  "http://7xs0af.com1.z0.glb.clouddn.com/High-Viva-La-Vida.mp3",
																  "http://7xs0af.com1.z0.glb.clouddn.com/High-Wake.mp3"];     
													function S() {        
														var e = document.getElementById("audio_element_id");        
														if(e != null){            
															var index = parseInt(e.getAttribute("curSongIndex"));            
															if(index > songs.length - 2) {                
																index = 0;            
															} else {                
																index++;            
															}            
															e.setAttribute("curSongIndex", index);            
															N();        
														}        
														e.src = i;        
														e.play()    
													}     
													function x(e) {        
														e.className += " " + s + " " + o    
													}     
													function T(e) {        
														e.className += " " + s + " " + u[Math.floor(Math.random() * u.length)]    
													}     
													function N() {        
														var e = document.getElementsByClassName(s);        
														var t = new RegExp("\\b" + s + "\\b");        
														for (var n = 0; n < e.length; ) {            
															e[n].className = e[n].className.replace(t, "")        
														}    
													}    
													function initAudioEle() {        
														var e = document.getElementById("audio_element_id");        
														if(e === null){            
															e = document.createElement("audio");            
															e.setAttribute("class", l);            
															e.setAttribute("curSongIndex", 0);            
															e.id = "audio_element_id";            
															e.loop = false;            
															e.bgcolor = 0;            
															e.addEventListener("canplay", function() {            
																setTimeout(function() {                
																	x(k)            
																}, 500);            
																setTimeout(function() {                
																	N();                
																	p();                
																	for (var e = 0; e < O.length; e++) {
																		T(O[e])                
																	}            
																}, 15500)       
															}, true);        
															e.addEventListener("ended", function() {
																N();            
																h();            
																go();        
															}, true);        
															e.innerHTML = " <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p> <p>";        
															document.body.appendChild(e);        
														}    
													}        
													initAudioEle();    
													var e = 30;    
													var t = 30;    
													var n = 350;    
													var r = 350;    
													var curSongIndex = parseInt(document.getElementById("audio_element_id").getAttribute("curSongIndex"));    
													var i = songs[curSongIndex];        
													var s = "mw-harlem_shake_me";    
													var o = "im_first";    
													var u = ["im_drunk", "im_baked", "im_trippin", "im_blown"];    
													var a = "mw-strobe_light";    
													var f = "/harlem-shake-style.css";        
													var l = "mw_added_css";    var b = g();    
													var w = y();    
													var C = document.getElementsByTagName("*");    
													var k = null;    
													for (var L = 0; L < C.length; L++) {        
														var A = C[L];        
														if (v(A)) {            
															if (E(A)) {                
																k = A;                
																break            
															}       
														}   
													}    
													if (A === null) {        
														console.warn("Could not find a node of the right size. Please try a different page.");        
														return    
													}    
													c();    
													S();    
													var O = [];    
													for (var L = 0; L < C.length; L++) {        
														var A = C[L];        
														if (v(A)) {            
															O.push(A)        
														}    
													}    
												})()' >
              High一下
            </a>
          </div>
        
		


        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/ryanlijianchang" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/ryan2lee" target="_blank">
                  
                    <i class="fa fa-weibo"></i> Weibo
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.douban.com/people/ryane/" target="_blank">
                  
                    <i class="fa fa-globe"></i> DouBan
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/li-jian-chang-68" target="_blank">
                  
                    <i class="fa fa-globe"></i> ZhiHu
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.csdn.net/ljcitworld" target="_blank">
                  
                    <i class="fa fa-globe"></i> CSND
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ryane Lee</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=0.5.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"ryane"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>

  
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/MathJax.js"></script>
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/config/TeX-AMS-MML_HTMLorMML.js"></script>
  


  

  
  
</body>
</html>
